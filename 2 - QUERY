---- INDICE PARA AUXILIAR NA CONSULTA

CREATE NONCLUSTERED INDEX IX_CLIENTE ON CLIENTE (DT) INCLUDE (ID_CLIENTE)

---- VERSÃO 1 

SELECT
	ID_CLIENTE,
	DT

FROM CLIENTE A 
WHERE
	CONVERT(DATE,DT,103) BETWEEN '20190709' AND CONVERT(DATE,GETDATE())

-- FORÇANDO INDICE

SELECT
	ID_CLIENTE,
	DT

FROM CLIENTE A WITH (INDEX = IX_CLIENTE)
WHERE
	CONVERT(DATE,DT,103) BETWEEN '20190709' AND CONVERT(DATE,GETDATE())

---

IF OBJECT_ID('tempdb..#DATAS') IS NOT NULL DROP TABLE #DATAS

DECLARE @DATA_PASSADA DATETIME = '20190709'

;WITH DT
AS
(
	SELECT 
		@DATA_PASSADA AS DT
	UNION ALL
	SELECT
		DATEADD(DAY,1,DT)
	FROM
		DT
	WHERE
		DT < CONVERT(DATE,GETDATE())
)
SELECT CONVERT(VARCHAR,DT,103) AS DT_TMP INTO #DATAS FROM DT
OPTION(MAXRECURSION 0)

SELECT
	ID_CLIENTE,
	DT

FROM CLIENTE A
WHERE
	EXISTS ( SELECT * FROM  #DATAS B WHERE B.DT_TMP = A.DT )

	
